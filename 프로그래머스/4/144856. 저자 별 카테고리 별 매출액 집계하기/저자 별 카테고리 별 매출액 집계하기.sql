-- 코드를 입력하세요
SELECT A.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY, SUM(B.PRICE*BS.SALES) AS TOTAL_SALES
FROM BOOK B
JOIN AUTHOR A
ON B.AUTHOR_ID = A.AUTHOR_ID
JOIN BOOK_SALES BS
ON B.BOOK_ID = BS.BOOK_ID AND BS.SALES_DATE BETWEEN '2022-01-01' and '2022-01-31'
GROUP BY A.AUTHOR_ID, B.CATEGORY
ORDER BY A.AUTHOR_ID ASC, B.CATEGORY DESC

;


# SELECT A.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY, B.PRICE, BS.SALES
# FROM BOOK B
# JOIN AUTHOR A
# ON B.AUTHOR_ID = A.AUTHOR_ID
# JOIN BOOK_SALES BS
# ON B.BOOK_ID = BS.BOOK_ID
# GROUP BY B.BOOK_ID
# ORDER BY A.AUTHOR_ID ASC , B.CATEGORY ASC

# ;

# 44000+60000+27000 = 131000
# 1	홍길동	경제	2232000
# 1	홍길동	경제	1539000
# 1	홍길동	인문	1980000
# 2	김영호	소설	1207500
# 3	김수진	기술	2728000
# 3	김수진	기술	1568000
# 3	김수진	생활	2147000